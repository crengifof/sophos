
-- https://community.sophos.com/intercept-x-endpoint/p/query-forum --


------

-- Services (Malware Persistence) --

SELECT

s.display_name,
s.path,
s.status,
s.start_type,
s.service_type,
REPLACE(REGEX_SPLIT(s.path, ' [-/]', 0), '"', '') AS filepath,
p.mlScore,
p.puaScore,
p.localRep,
p.globalRep,
p.sha256,
p.localRepData

FROM services s
JOIN sophos_file_properties p ON p.pathname=filepath;


------

Note:

There is very little point in trying to extract the json data in the localRepData field as that almost certainly would cause the query to fail when a non binary file is found.


